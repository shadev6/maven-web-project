<?php  
session_start();  
if (isset($_POST['Submit'])){ $capacity=$_POST['capacity']; $journey_code=$_POST['joruney_code']; $train_id=$_POST['train_id']; $usage_rate=$_POST['usage_rate'];  
$servername = "localhost";  
$username = "root";  
$password ="";  
$dbname = "webjti";  
try {  
$conn = new PDO ("mysql:host=$servername; dbname=$dbname", $username, $password); 

// set the PDO error mode to exception  
$conn->setAttribute (PDO:: ATTR_ERRMODE, PDO:: ERRMODE_EXCEPTION);  
  

// prepare sql and bind parameters  
//$stmt = $conn ->prepare("SELECT * FROM `train_info` WHERE capacity >= $capacit 

//$stmt = $conn->prepare("SELECT * FROM `train_info` WHERE 1");  
$stmt = $conn->prepare("SELECT train_id, journey_code, capacity, usage_rate FROM `train_info` WHERE `capacity` >= $capacity AND `usage_rate` < $usage_rate"); 

  

//$stmt = $conn->prepare("SELECT train_id, journey_code, capacity, usage_rate FROM  
//echo $capacity; echo $md5password;  
//$stmt->bindParam(': capacity', $capacity, ':joruney_code', $journey_code); 

$results = $stmt->execute();  

if ($results){  
$rows =$stmt->fetchAll();  
print_r($rows);  
  

foreach ($rows as $row) {  
//echo $row["capacity"] . $row["journey_code"].' '.$row["train_id"];  

echo "</br>";  
echo "20065334 shaiful karim";  
echo "</br>";  
echo "</br>";  

echo "Train ID = ";
echo $row["train_id"];  
echo "</br>";  

echo "Journey code= ";  
echo $row["journey_code"];  
echo "</br>";  

echo "Maximum passenger capacity";  
echo $row["capacity"];  
echo "</br>";  

echo "Current usage rate = ";
echo $row["usage_rate"];  
echo "</br>";  

//echo $row["capacity"].' '.$row["usage_rate"];  
}  
}  
}  
catch (PDOException $e)  
{  
echo "Error: ".$e->getMessage();  
}  
$conn = null;  
echo ('<a href="index.php">Go back to search page</a>');  
}  
else  
{  
?>  
<form method="POST" action="#" >  
<br>20065334 shaiful</br>  
<br></br>  
<br>Search trains:</br>  
<br></br>  
<br>Maximum capacity greater than or equals:  
<input type='textbox' length=25 name='capacity'></input> 
</br>  

<br>Current usage rate less than:  
<input type='textbox' length=25 name='usage_rate'></input>% </br>  
<br><input type='Submit' name='Submit' value='Submit'></input>  
</form> 
<?php  
}  
?>
